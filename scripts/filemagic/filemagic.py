import argparse
import xlsxwriter
from PIL import Image

class Filemagic:
    def __init__(self):
        self.parser = argparse.ArgumentParser(prog="PROG")
        self.args = None
        self.file = None
        self.backdoor = None
        self.code = None
        self.extension = None

    def argparser(self):
        self.parser.add_argument('-f', '--file', help="File to be read")
        self.parser.add_argument('-b', '--backdoor', help="Backdoor to imbedd")
        self.parser.add_argument('-c', '--code', help="Code to imbedd")
        self.parser.add_argument('-e', '--extension', help="File-extension to generate")
        self.args = vars(self.parser.parse_args())
        return self.args

    def set_args(self):
        for arg in self.args:
            print(arg)

    def generate_file(self):
        pass

    def read_file(self):
        pass

    def imbedd_backdoor(self):
        pass

    def imbedd_code(self):
        pass


def main():
    filemagic = Filemagic()
    filemagic.argparser()
    filemagic.set_args()

    img = Image.new('RGB', (300, 300))
    img.save('test.png')

    workbook = xlsxwriter.Workbook('example.xlsx')
    worksheet = workbook.add_worksheet()

    worksheet.write('A1', 'Hello, Excel!')
    workbook.close()

if __name__ == '__main__':
    main()
