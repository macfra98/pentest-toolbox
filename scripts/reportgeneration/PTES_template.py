from docx import Document
from docx.shared import Inches
from infogen import *

def document_template():
    document = Document()

    recommendations = generate_information() 
    
    date_name_org = document.add_paragraph("""Name: \nDate: \nOrg: \n""")
    document.add_heading("Pentest Report", 0)
    p1_p = document.add_paragraph("Vulnerabilityanalys of XXXXXX")
    document.add_page_break()    

    p2_p1_h = document.add_heading("Methodology", 1)
    p2_p1_h_text = document.add_paragraph("The Penetration Testing Execution Standard (PTES) is a detailed guide for conducting penetration tests, created by security experts. It standardizes testing methods, helping security professionals and businesses. It covers testing from planning to reporting, and emphasizes a tailored approach for each organization's needs. The PTES improves penetration testing effectiveness.")

    p2_p2 = document.add_heading("Pre-engagement Interactions", 2)
    p2_p2_text = document.add_paragraph("This is the preparation phase for the pen test. It is all about document approvals and tools needed for the test.")

    p2_p3 = document.add_heading("Intellegence Gathering", 2)
    p2_p3_text = document.add_paragraph("In this phase information about the target system are gathered from external sources like social media websites, official records etc. This phase comes under OSINT (Open-Source Intelligence).")

    p2_p4 = document.add_heading("Threat Modelling", 2)
    p2_p4_text = document.add_paragraph("It is a procedure for optimizing network security by identifying objectives and vulnerabilities, and then defining countermeasures to prevent, or mitigate the effects of, threats to the system. It is skipped in typical pan tests.")

    p2_p5 = document.add_heading("Vulnerability Analysis", 2)
    p2_p5_text = document.add_paragraph("This phase discovers and validates vulnerabilities.That is risk that an attacker could exploit and gain authorized access to the system or application.")

    p2_p6 = document.add_heading("Exploitation", 2)
    p2_p6_text = document.add_paragraph("In this phase, the tester try to reach the security of the target system using the vulnerabilities previously identified and validated.")

    p2_p7 = document.add_heading('Post Exploitation', 2)
    p2_p7_text = document.add_paragraph("This phase maintains the control over target system and collects data.")

    p2_p8 = document.add_heading("Reporting", 2)
    p2_p8_text = document.add_paragraph("Documents entire process in a form understandable to the client.")
    document.add_page_break()    

    p3_p1_h = document.add_heading("Results", 1)
    p3_p1_h_text = document.add_paragraph("Result presents all the findings, how, and why the finding was discovered. Results also presents if the discovered vulnerability is a threat.")
    document.add_page_break()    
    
    p4_p1_h = document.add_heading("Recommendations", 1)
    p4_p1_h_text = document.add_paragraph("Recommendations presents all the recommendations for mitigating and avoiding these types of vulnerabilities.")

    for vuln_name, vuln_desc in recommendations:
        p4_p = document.add_heading(vuln_name, 3)
        p4_p = document.add_paragraph(vuln_desc)

    document.add_page_break()

    return document
