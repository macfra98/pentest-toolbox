import argparse
import sys

class Tools:
    def __init__(self):
        self.parser = argparse.ArgumentParser(prog="""
        artifact:       --> generates shellcode and imbedds the code automatically. (unfinished)
        binsploit:      --> fetches binary exploits based on GTFObins (finished)
        filemagic:      --> generates files and imbedds backdoors (semi-finished)
        passcrack:      --> password cracker tool (hashes) (semi-finished)
        repgen:         --> generates reports/notes (unfinished)
        knock:          --> portscanner (unfinished)
        """)

        self.args = None

        if len(sys.argv) == 1:
            print(self.parser.print_help(sys.stderr))
            sys.exit(1)
        
    def argparser(self):
        self.parser.add_argument('-t', '--tool', help="Select tool to get more information about",
                                 required=True)
        self.args = vars(self.parser.parse_args()) 
    
    def tool_guide(self):
        if self.args['tool'] == 'artifact':
            print("""
            [ARTIFACT GUIDE]
            artifact -t base64 -s download -i 127.0.0.1 -p 1337 -e ps1 -o windows/x64

            """)
        elif self.args['tool'] == 'binsploit':
            print("""
            [BINSPLOIT GUIDE]

            $ binsploit
            -> <enter binary type here>
            -> <choose option>
            """)
        elif self.args['tool'] == 'passcrack':
            print("""
            [PASSCRACK GUIDE]
            
            passcrack -w <wordlist> -f <hashfile>
            passcrack -m <mode> -w <wordlist> -f <hashfile/hash>
            """)
        elif self.args['tool'] == 'filemagic':
            print("""
            [FILEMAGIC GUIDE]

            filemagic -e png -b php
            filemagic -e gif -b c
            filemagic -e jpeg -b rb
            filemagic -e jpeg -c <your code here>
            """)
        elif self.args['tool'] == 'repgen':
            print("""
            [REPGEN GUIDE]

            repgen
            [0] generate notes
            [1] generate report
            -> <option>
            """)
        elif self.args['tool'] == 'knock':
            print("""
            [KNOCK GUIDE]

            temp...
            """)
        elif self.args['tool'] == 'vulnscanner':
            print("""
            [VULNSCANNER GUIDE]

            vulnscanner -i 127.0.0.1 -p 1234,5555,9001
            vulnscanner -i 127.0.0.1 -p-
            """)
        elif self.args['tool'] == 'apibrute':
            print("""
            [APIBRUTE GUIDE]
            
            apibrute --user <user> --url <url> --wordlist <path_to_passwordsfile>
            """)


def main():
    tools = Tools()
    tools.argparser()
    tools.tool_guide()

if __name__ == '__main__':
    main()
